---
title: "Q1"
author: "Arindom Baruah (32779267)"
format: html
---

## Exercise 1

The [blog post by Manuel Rademaker](https://www.manuel-rademaker.com/blog/tidy_tuesday/2021_05_15_ceo_depatures/) describes a neat analysis of the [Tidy Tuesday](https://github.com/rfordatascience/tidytuesday) data on CEO departures. Re-run this analysis for yourself. Report any problems reproducing the results. Your primary task for this exercise is to outline all of the parts of the analysis, and label them as EDA, IDA or confirmatory analysis.

```{r global-settings}

knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE,
                      fig.align = "center")

```


```{r library-setup,message=FALSE,warning=FALSE}

library(ggplot2)
library(tidytuesdayR)
library(tidyverse)
library(visdat)
```



```{r load-data,message=FALSE,warning=FALSE}
ceo <- read_csv("departures.csv")
```


The data for CEO departures has been sourced from the [Tidy Tuesday](https://github.com/rfordatascience/tidytuesday) library. The analysis will be re-run and each section will be classified into one of the following types of analysis:

1. Initial Data Analysis:
2. Exploratory Data Analysis: 
3. Confirmatory Data Analysis:


# Visualising the various datatypes in each variable

```{r}
dim(ceo)
## [1] 9423   20
vis_dat(ceo)
```

The above plot allows us to understand the various types of datatypes in each of the 20 variables in the dataset. The greyed out sections indicate the presence of null values in the dataset, while the colored sections indicate the corresponding datatype for each variable.

Such a type of analysis allows us to understand the distribution of missing values, and the types of datatypes present in the dataset, further laying the path for the data pre-processing techniques to be used in later part of the analysis. Hence, we can classify such an analysis as __Initial Data Analysis__.

# Develop research questions and hypotheses

The following research questions were posed for the current dataset.

1. What is the distribution of CEO departure reasons (by year (or every 5 years), overall)?
2. Does the distribution change over the years (i.e. are CEOs now more likely to be removed for legal reasons for example)?
3. Do CEOs that are fired (3 & 4) get fired again more often than others? Or in general: whats the likelihood of departing for reason x given reason y for dismissal.
4. Look at companies and their CEO turnover. Which companies stand out (e.g., because they dismiss many CEOs).
5. If possible, look at the history of some interesting CEOs. Maybe there are some that stand out (e.g. because they always left for legal reasons).

Setting up specific research questions and addressing key strategies to answer such questions generally forms a part of the __confirmatory data analysis__.


# Reason for CEO departure

```{r ceodep, fig.cap="Initial CEO departure barplot"}
ggplot(ceo, aes(y = departure_code)) + 
   geom_bar(fill = "lightblue") +
   labs(
      title    = "Reason for CEO departure",
      x = "",
      y = ""
   )
```
As figure \@ref(fig:ceodep) does not provide much information regarding CEO departures, the following techniques were done to improve the plot.

```{r}
ceo %>% 
   group_by(fyear, departure_code) %>% 
   count()
```

```{r}
ceo_reduced <- ceo %>% 
   filter(departure_code %in% 3:7) %>% 
   mutate(
      departure_label = as.factor(recode(departure_code,
         `3` = "Bad performance",
         `4` = "Legal",
         `5` = "Retired",
         `6` = "New opportunity",
         `7` = "Other")),
      fyear = lubridate::make_date(fyear)) %>% 
   relocate(fyear, departure_label)
```


```{r}
ceo_reduced %>% 
   group_by(departure_label) %>% 
   count() %>% 
   ggplot(aes(y = fct_reorder(departure_label, n), x = n)) + 
   geom_col(fill = main_color) +
   labs(
      title = "CEO depature by reason",
      subtitle = "S&P 1500 firms between 1987 - 2019",
      x = "",
      y = "",
      caption = "Source: Gentry et al."
   ) + 
   scale_x_continuous(breaks = scales::breaks_width(500))
```


